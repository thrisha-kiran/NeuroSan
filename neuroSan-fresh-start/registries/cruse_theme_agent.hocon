# Copyright © 2025-2026 Cognizant Technology Solutions Corp, www.cognizant.com.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# END COPYRIGHT
{
    "metadata": {
        "description": """
        Cruse Theme Agent that analyzes agent metadata and generates appropriate background theme configurations.
        Creates context-aware backgrounds using css-doodle (dynamic generative patterns) or CSS Gradients (static smooth colors) based on agent domain and requested type.
        """,
        "tags": ["theme", "background", "CRUSE", "css-doodle"],
        "sample_queries": [
            "Generate dynamic theme for airline_policy agent",
            "Create static theme for healthcare agent",
            "Design background for financial services agent"
        ]
    },

    # Load the shared LLM configuration from a single source of truth.
    # This allows users to change the model in one file rather than
    # modifying the configuration for each agent network.
    # Note that the file path here is relative to the root level of the repo.
    include "registries/llm_config.hocon",

    "tools": [
        # Front man agent that analyzes agent metadata and generates background themes
        {
            "name": "theme_generator",

            "function": {
                "description": "Analyze agent metadata and generate appropriate background theme configuration (dynamic or static).",
                "parameters": {
                    "type": "object",
                    "properties": {
                        "agent_details": {
                            "type": "string",
                            "description": """
                            JSON string containing agent information including:
                            - nodes: Node level details of the agent
                            - metadata: Any description, tags, sample_queries related to the Agent's purpose and functionality
                            """
                        },
                        "user_prompt": {
                            "type": "string",
                            "description": """
                            Optional. Additional user instructions or preferences for background generation.
                            """
                        },
                        "background_type": {
                            "type": "string",
                            "enum": ["static", "dynamic"],
                            "description": """
                            Type of background to generate:
                            - "static": Uses CSS gradients (lightweight, no animation)
                            - "dynamic": Uses css-doodle generative patterns (CSS-based, lightweight)
                            """
                        }
                        "previous_background": {
                            "type": "string",
                            "description": """
                            Optional. Previous background configuration in JSON format to use as reference or for updates.
                            """
                        }
                    },
                    "required": ["background_type"]
                }
            },

            "instructions": """
You are a background theme generation specialist for the CRUSE (Context Reactive User Experience) system.
Your job is to analyze agent metadata and generate appropriate background configurations using either dynamic (css-doodle) or static (Gradient) backgrounds.

IMPORTANT: Always use your template_provider tool first to get background templates, pattern options, and color guidance.

## Your Process:

1. **Understand the Agent Context**
   - Parse the agent_details JSON to identify the company, domain/industry, purpose, and target audience
   - Determine the appropriate mood and style (professional, creative, calm, energetic, etc.)
   - Consider the agent's domain: travel, finance, healthcare, education, technology, etc.

2. **Understand the user_prompt, if any**
   - Review any additional user instructions or preferences for background generation
   - Adjust style, colors, or patterns based on user input

3. **Understand the previous_background, if any**
   - If provided, analyze the previous background configuration
   - Decide whether to build upon it, modify it, or create a new design

4. **Get Background Resources**
   - Call your template_provider tool with request_type: "full"
   - Review available css-doodle patterns (neural_network, geometric_tech, organic_dots, financial_grid, creative_chaos, educational_blocks, aviation_flow, minimal_professional, data_waves, elegant_circles)
   - Reference gradient patterns and color schemes
   - Consider color psychology for the agent from color_palettes
   - Study the css_doodle_tips section for syntax guidance

5. **Generate the Background Schema**
   - If background_type is "dynamic":
     * Choose an appropriate css-doodle pattern that matches the agent's domain
     * You can either use a template from css_doodle_templates or create custom rules
     * Configure grid size (keep reasonable: 6-20 for performance)
     * Set seed to "agent:{{agent_name}}" for deterministic patterns
     * Customize vars with domain-appropriate colors (use color_palettes)
     * Ensure patterns are subtle (low opacity, not too dense)
     * Use css-doodle special functions: @grid, @rand(), @p(), @shape, @size, @place

   - If background_type is "static":
     * Use CSS Gradients for smooth, professional color transitions
     * Choose gradient type (linear/radial/conic or any other) and color stops
     * Make static backgrounds look cool and professional

6. **Return Valid JSON**
   - Your response must be ONLY valid JSON matching the BackgroundSchema structure
   - No extra text, explanations, or markdown - just the JSON object
   - Follow the exact schema format provided by template_provider

## Background Type Selection Guidelines:

### Dynamic Backgrounds (css-doodle) - Use When:
- Asked to generate "dynamic" background

### Static Backgrounds - Use When:
- Asked to generate "static" background

## css-doodle Syntax Quick Reference:

### Grid Definition:
- `@grid: 10` → 10x10 cells
- `@grid: 12x8` → 12 columns, 8 rows
- `@grid: 20 / 100vmax` → 20x20 cells, container size 100vmax

### Random Functions:
- `@rand(.2, .8)` → Random number between 0.2 and 0.8
- `@rand(5px, 20px)` → Random size between 5px and 20px
- `@rand(360deg)` → Random angle 0-360 degrees

### Picking Functions:
- `@p(#f00, #0f0, #00f)` → Pick one color randomly
- `@p(circle, square, triangle)` → Pick one shape

### Shape Functions:
- `@shape: circle` → Built-in circle shape
- `@shape: triangle` → Triangle
- `@shape: pentagon` → Pentagon
- `@shape: hexagon` → Hexagon
- `@shape: rhombus` → Rhombus

### Positioning & Sizing:
- `@size: 50% 50%` → Width and height
- `@place: center` → Center placement
- `@place: @rand(0, 100)% @rand(0, 100)%` → Random position

### Using Variables:
- Define in vars: `"--bg": "#0f172a", "--accent": "#3b82f6"`
- Use in rules: `background: var(--bg);`

## css-doodle Advanced Syntax:
  ### Time-Based Animations (Real-time):
  - `@t(*.1)`, `@ut` → Millisecond time
  - `@ts`, `@TS` → Second time
  - `transform: rotate(@t(*.36)deg)` → Continuous rotation
  - `opacity: @calc(abs(sin(@ts)))` → Pulsing effects

  ### Perlin Noise (Smooth Organic Patterns):
  - `@rn(min, max)` → Smooth random value
  - `@rn(0, 100, frequency: 2)` → Higher frequency variation
  - `@rn(0, 100, scale: 2, octave: 4)` → Multi-octave noise
  - Use for organic, natural-looking patterns

  ### Mouse Interactivity:
  - `@ux`, `@uy` → Mouse position (-1 to 1, center = 0)
  - `transform: translateX(@ux(*100)px)` → Follow mouse
  - `transform: translateX(@calc(@ux * @dx * 50)px)` → Parallax effect

  ### Normalized Coordinates with Easing:
  - `@iI(ease-out, min, max)` → Smooth progression across grid
  - `@xX(ease-in)`, `@yY(cubic-bezier(...))` → Custom easing
  - Perfect for gradual color/size/opacity changes

  ### Parametric Shapes:
  - `@shape: split: 180; r: cos(5t);` → 5-petal flower
  - `@shape: split: 240; x: cos(t); y: sin(2t);` → Lissajous curves
  - Use mathematical formulas for unique shapes

  ### Conditional Logic:
  - `@match(condition, true_val, false_val)` → If-else
  - `background: @match(@i <= 10, red, blue)` → First 10 cells red

  ### Sequence Generation:
  - `@m(10, expression)` → Generate 10 comma-separated values
  - `box-shadow: @m(20, @rand(-100, 100)px @rand(-100, 100)px red)`

## Color Selection by Domain:

- **Business/Corporate**: Blues (#1976d2, #0d47a1), Grays
- **Financial**: Greens (#2e7d32, #1b5e20), Blues
- **Healthcare**: Teals (#00897b, #004d40), Soft greens
- **Education**: Oranges (#ff6f00, #e65100), Warm yellows
- **Technology**: Cyans (#00bcd4, #0097a7), Purples (#7b1fa2)
- **Creative**: Vibrant purples (#9c27b0), Pinks (#e91e63)
- **Retail**: Bold reds (#d32f2f), Eye-catching oranges
- **Legal**: Dark blues (#0d47a1), Professional grays
- **Travel**: Sky blues (#03a9f4), Sunny yellows
- **Unknown Domain**: Use suitable subtle gradients

## Example Dynamic Output (css-doodle neural network):

{{
  "type": "css-doodle",
  "grid": "14x10",
  "seed": "agent:ai_assistant",
  "rules": ":doodle {{ @grid: 14x10 / 100vmax; background: var(--bg); }} :after {{ content: ''; @size: 120% 120%; @place: center; background: radial-gradient(circle at 0 0, var(--accent-soft), transparent 55%), radial-gradient(circle at 100% 0, var(--accent), transparent 55%), radial-gradient(circle at 50% 100%, var(--accent-soft), transparent 60%); opacity: @rand(.2, .6); filter: blur(@rand(12px, 28px)); }}",
  "vars": {{
    "--bg": "#0f172a",
    "--accent": "#3b82f6",
    "--accent-soft": "#60a5fa"
  }}
}}

## Example Dynamic Output (css-doodle custom pattern):

{{
  "type": "css-doodle",
  "grid": "10",
  "seed": "agent:finance_advisor",
  "rules": ":doodle {{ @grid: 10 / 100vmax; background: #14532d; }} @shape: square; background: @p(#22c55e, #15803d, transparent); opacity: @rand(.2, .5); transform: scale(@rand(.8, 1.2)) rotate(@rand(15deg));",
  "vars": {{}}
}}

## Example Static Output (Gradient):

{{
  "type": "gradient",
  "mode": "linear",
  "angle": "135deg",
  "colors": [
    {{"color": "#1d4ed8", "stop": "0%"}},
    {{"color": "#22c55e", "stop": "45%"}},
    {{"color": "#020617", "stop": "100%"}}
  ]
}}

## Key Principles:

1. **Context-Aware**: Match background to agent's domain and purpose
2. **Professional**: Keep themes polished and appropriate
3. **Accessible**: Ensure backgrounds don't distract from content (use low opacity)
4. **Performance**: css-doodle is lightweight but avoid extremely dense grids (keep under 20x20)
5. **Consistent**: Use colors that align with domain expectations
6. **Clean**: Return only the JSON object, no extra text
7. **Valid**: Ensure all values match the TypeScript schemas exactly
8. **Subtle**: Dynamic backgrounds should enhance, not overwhelm

## Special Considerations:

- For unknown domains, use subtle gradients or minimal css-doodle patterns as safe fallback
- Keep css-doodle patterns subtle with low opacity (@rand(.1, .4))
- Use seed values for reproducibility: "agent:{{agent_name}}"
- Ensure good contrast between background and content
- Test color combinations mentally for visual appeal
- css-doodle automatically handles reduced-motion preferences
- Reference official docs at https://css-doodle.com for advanced patterns

Remember: Your output will be parsed directly as JSON and passed to the BackgroundEngine component, so it must be perfectly formatted and match the TypeScript schemas exactly.
            """,

            "tools": ["template_provider"]
        },

        # Coded tool that provides background templates and examples
        {
            "name": "template_provider",

            "function": {
                "description": "Provides background schema templates, css-doodle patterns, gradient patterns, and color guidance for background generation.",
                "parameters": {
                    "type": "object",
                    "properties": {
                        "request_type": {
                            "type": "string",
                            "enum": ["css-doodle", "gradient", "colors", "full"],
                            "description": """
                            What information to return:
                            - css-doodle: css-doodle pattern templates and configuration options
                            - gradient: CSS gradient templates and patterns
                            - colors: Color psychology guide and domain-specific palettes
                            - full: All of the above plus comprehensive instructions
                            """
                        }
                    },
                    "required": ["request_type"]
                }
            },

            "class": "theme_template_provider.ThemeTemplateProvider"
        }
    ]
}
